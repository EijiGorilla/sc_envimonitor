"use strict";(self.webpackChunksc_envimonitor=self.webpackChunksc_envimonitor||[]).push([[519],{20519:(e,a,r)=>{r.d(a,{k:()=>w,populateOperationalLayers:()=>u});var y=r(9236),t=r(80987),i=(r(93169),r(28458)),n=r(19610),o=r(98995);function L(e,a){return!(!e.layerType||"ArcGISFeatureLayer"!==e.layerType)&&e.featureCollectionType===a}var l=r(43139),c=r(21371);async function u(e,a,r){if(!a)return;const t=a.map((e=>async function(e,a){return async function(e,a,r){const t=new e;return t.read(a,r.context),"group"===t.type&&("GroupLayer"===a.layerType?await w(t,a,r):A(a)?function(e,a,r){a.itemId&&(e.portalItem=new o.default({id:a.itemId,portal:null===r||void 0===r?void 0:r.portal}),e.when((()=>{var y,t;const i=y=>{var t;const i=y.layerId;h(y,e,a,i,r);const n=null===(t=a.featureCollection)||void 0===t||null===(t=t.layers)||void 0===t?void 0:t[i];n&&y.read(n,r)};null!==(y=e.layers)&&void 0!==y&&y.forEach(i),null===(t=e.tables)||void 0===t||t.forEach(i)})))}(t,a,r.context):m(a)&&await async function(e,a,r){var t;const i=n.T.FeatureLayer,o=await i(),L=a.featureCollection,l=null===L||void 0===L?void 0:L.showLegend,c=null===L||void 0===L||null===(t=L.layers)||void 0===t?void 0:t.map(((t,i)=>{const n=new o;n.read(t,r);const L=(0,y.Z)((0,y.Z)({},r),{},{ignoreDefaults:!0});return h(n,e,a,i,L),null!=l&&n.read({showLegend:l},L),n}));e.layers.addMany(null!==c&&void 0!==c?c:[])}(t,a,r.context)),await(0,c.y)(t,r.context),t}(await M(e,a),e,a)}(e,r))),i=await Promise.allSettled(t);for(const y of i)"rejected"===y.status||y.value&&e.add(y.value)}const s={ArcGISDimensionLayer:"DimensionLayer",ArcGISFeatureLayer:"FeatureLayer",ArcGISImageServiceLayer:"ImageryLayer",ArcGISMapServiceLayer:"MapImageLayer",ArcGISSceneServiceLayer:"SceneLayer",ArcGISTiledElevationServiceLayer:"ElevationLayer",ArcGISTiledImageServiceLayer:"ImageryTileLayer",ArcGISTiledMapServiceLayer:"TileLayer",BuildingSceneLayer:"BuildingSceneLayer",CatalogLayer:"CatalogLayer",CSV:"CSVLayer",DefaultTileLayer:"TileLayer",GeoJSON:"GeoJSONLayer",GroupLayer:"GroupLayer",IntegratedMesh3DTilesLayer:"IntegratedMesh3DTilesLayer",IntegratedMeshLayer:"IntegratedMeshLayer",KML:"KMLLayer",LineOfSightLayer:"LineOfSightLayer",MediaLayer:"MediaLayer",OGCFeatureLayer:"OGCFeatureLayer",OrientedImageryLayer:"OrientedImageryLayer",PointCloudLayer:"PointCloudLayer",RasterDataLayer:"UnsupportedLayer",VectorTileLayer:"VectorTileLayer",ViewshedLayer:"ViewshedLayer",Voxel:"VoxelLayer",WFS:"WFSLayer",WMS:"WMSLayer",WebTiledLayer:"WebTileLayer"},d={ArcGISTiledElevationServiceLayer:"ElevationLayer",DefaultTileLayer:"ElevationLayer",RasterDataElevationLayer:"UnsupportedLayer"},p={ArcGISFeatureLayer:"FeatureLayer"},S={ArcGISImageServiceLayer:"UnsupportedLayer",ArcGISMapServiceLayer:"UnsupportedLayer",ArcGISSceneServiceLayer:"SceneLayer",ArcGISTiledImageServiceLayer:"ImageryTileLayer",ArcGISTiledMapServiceLayer:"TileLayer",DefaultTileLayer:"TileLayer",OpenStreetMap:"OpenStreetMapLayer",VectorTileLayer:"VectorTileLayer",WMS:"UnsupportedLayer",WebTiledLayer:"WebTileLayer"},I={ArcGISAnnotationLayer:"UnsupportedLayer",ArcGISDimensionLayer:"UnsupportedLayer",ArcGISFeatureLayer:"FeatureLayer",ArcGISImageServiceLayer:"ImageryLayer",ArcGISImageServiceVectorLayer:"ImageryLayer",ArcGISMapServiceLayer:"MapImageLayer",ArcGISStreamLayer:"StreamLayer",ArcGISTiledImageServiceLayer:"ImageryTileLayer",ArcGISTiledMapServiceLayer:"TileLayer",BingMapsAerial:"BingMapsLayer",BingMapsHybrid:"BingMapsLayer",BingMapsRoad:"BingMapsLayer",CatalogLayer:"CatalogLayer",CSV:"CSVLayer",DefaultTileLayer:"TileLayer",GeoJSON:"GeoJSONLayer",GeoRSS:"GeoRSSLayer",GroupLayer:"GroupLayer",KML:"KMLLayer",KnowledgeGraphLayer:"KnowledgeGraphLayer",MediaLayer:"MediaLayer",OGCFeatureLayer:"OGCFeatureLayer",OrientedImageryLayer:"OrientedImageryLayer",SubtypeGroupLayer:"SubtypeGroupLayer",VectorTileLayer:"VectorTileLayer",WFS:"WFSLayer",WMS:"WMSLayer",WebTiledLayer:"WebTileLayer"},v={ArcGISFeatureLayer:"FeatureLayer",SubtypeGroupTable:"UnsupportedLayer"},T={ArcGISImageServiceLayer:"ImageryLayer",ArcGISImageServiceVectorLayer:"ImageryLayer",ArcGISMapServiceLayer:"MapImageLayer",ArcGISTiledImageServiceLayer:"ImageryTileLayer",ArcGISTiledMapServiceLayer:"TileLayer",BingMapsAerial:"BingMapsLayer",BingMapsHybrid:"BingMapsLayer",BingMapsRoad:"BingMapsLayer",DefaultTileLayer:"TileLayer",OpenStreetMap:"OpenStreetMapLayer",VectorTileLayer:"VectorTileLayer",WMS:"WMSLayer",WebTiledLayer:"WebTileLayer"},g=(0,y.Z)((0,y.Z)({},I),{},{LinkChartLayer:"LinkChartLayer"}),G=(0,y.Z)({},v),f=(0,y.Z)({},T);async function M(e,a){var r,y;const t=a.context,c=b(t);let u=e.layerType||e.type;!u&&(null===a||void 0===a?void 0:a.defaultLayerType)&&(u=a.defaultLayerType);const s=c[u];let d=s?n.T[s]:n.T.UnknownLayer;if(A(e)){const a=null===t||void 0===t?void 0:t.portal;if(e.itemId){const r=new o.default({id:e.itemId,portal:a});await r.load();const y=(await(0,l.v)(r,new i.L)).className||"UnknownLayer";d=n.T[y]}}else"ArcGISFeatureLayer"===u?function(e){return L(e,"notes")}(e)||function(e){return L(e,"markup")}(e)?d=n.T.MapNotesLayer:function(e){return L(e,"route")}(e)?d=n.T.RouteLayer:m(e)&&(d=n.T.GroupLayer):null!==(r=e.wmtsInfo)&&void 0!==r&&r.url&&e.wmtsInfo.layerIdentifier?d=n.T.WMTSLayer:"WFS"===u&&"2.0.0"!==(null===(y=e.wfsInfo)||void 0===y?void 0:y.version)&&(d=n.T.UnsupportedLayer);return d()}function m(e){var a,r;return"ArcGISFeatureLayer"===e.layerType&&!A(e)&&(null!==(a=null===(r=e.featureCollection)||void 0===r||null===(r=r.layers)||void 0===r?void 0:r.length)&&void 0!==a?a:0)>1}function A(e){return"Feature Collection"===e.type}function b(e){let a;switch(e.origin){case"web-scene":switch(e.layerContainerType){case"basemap":a=S;break;case"ground":a=d;break;case"tables":a=p;break;default:a=s}break;case"link-chart":switch(e.layerContainerType){case"basemap":a=f;break;case"tables":a=G;break;default:a=g}break;default:switch(e.layerContainerType){case"basemap":a=T;break;case"tables":a=v;break;default:a=I}}return a}async function w(e,a,r){const y=new t.Z,i=u(y,Array.isArray(a.layers)?a.layers:[],r);try{try{if(await i,"group"===e.type)return e.layers.addMany(y),e}catch(n){e.destroy();for(const e of y)e.destroy();throw n}}catch(n){throw n}}function h(e,a,r,y,t){var i,n;e.read({id:"".concat(a.id,"-sublayer-").concat(y),visibility:null===(i=null===(n=r.visibleLayers)||void 0===n?void 0:n.includes(y))||void 0===i||i},t)}}}]);
//# sourceMappingURL=519.332383c9.chunk.js.map